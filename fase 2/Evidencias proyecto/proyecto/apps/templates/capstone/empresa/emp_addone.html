{% extends "layouts/base.html" %}

{% block title %} Crear empresa {% endblock %} 

<!-- Specific CSS goes HERE -->
{% block stylesheets %}{% endblock stylesheets %}

{% block content %}		
    <!-- [ Main Content ] start -->
    <section class="pcoded-main-container">
        <div class="pcoded-content">
            <!-- [ breadcrumb ] start -->
            <div class="page-header">
                <div class="page-block">
                    <div class="row align-items-center">
                        <div class="col-md-12">
                            <div class="page-header-title">
                                <h5 class="m-b-10">Crear empresa</h5>
                            </div>
                            <ul class="breadcrumb">
                                <li class="breadcrumb-item"><a href="/"><i class="feather icon-home"></i></a></li>
                                <li class="breadcrumb-item"><a href="#">Capstone</a></li>
                                <li class="breadcrumb-item"><a href="#!">Crear empresa</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <!-- [ breadcrumb ] end -->
            <!-- [ Main Content ] start -->
            <div class="row">
                <!-- [ form-element ] start -->
                <div class="col-sm-12">
                    <div class="card">
                        <div class="card-header">
                            <h5>Crear empresa</h5>
                        </div>
                        <div class="card-body">
                            <h5>Ingrese datos</h5>
                            <hr>
                            <div class="row">
                                <div class="col-md-8">
                                    <form method="POST" id="validation-form123">
                                        {% csrf_token %}
                                        {{ form.non_field_errors }}
                                        <div class="fieldWrapper">
                                            {{ form.EM_CNOMBRE.errors }}
                                            <label class="my-1 me-2" for="{{ form.EM_CNOMBRE.id_for_label }}">Ingrese nombre:</label>
                                            {{ form.EM_CNOMBRE }}
                                        </div>
                                        <div class="fieldWrapper">
                                            {{ form.EM_RUT.errors }}
                                            <label class="my-1 me-2" for="{{ form.EM_RUT.id_for_label }}">Ingrese Rut:</label>
                                            {{ form.EM_RUT }}
                                        </div>
                                        <div class="fieldWrapper">
                                            {{ form.COM_NID.errors }}
                                            <label class="my-1 me-2" for="{{ form.COM_NID.id_for_label }}">Seleccione comuna:</label>
                                            {{ form.COM_NID }}
                                        </div>
                                        <br>
                                        <hr>
                                        <div class="form-group nav justify-content-end">
                                            <button class="btn btn-success mr-4" type="submit">Guardar</button>
                                            <a class="btn btn-danger mr-1" onclick="window.history.go(-1); return false;">Volver</a>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- [ form-element ] end -->
            </div>
            <!-- [ Main Content ] end -->
        </div>
    </section>
    <!-- [ Main Content ] end -->
{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}
    <!-- bootstrap-tagsinput-latest Js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/typeahead.js/0.11.1/typeahead.bundle.min.js"></script>
    <script src="/static/assets/js/plugins/bootstrap-tagsinput.min.js"></script>
    <!-- bootstrap-maxlength Js -->
    <script src="/static/assets/js/plugins/bootstrap-maxlength.js"></script>
    <!-- form-advance custom js -->
    <script src="/static/assets/js/pages/form-advance-custom.js"></script>
    <script>
        $("#id_cliente").on("change", function(){
            var cliente = $(this).val();
            $.ajax({
                url: "/ajax_get_cliente_email/",
                data: {"cliente": cliente},
                dataType: "json",
                success: function(response){
                    if(response.valid){
                        $("#id_email").val(response.email);
                    } else {
                        $("#id_email").val("");
                        Swal.fire({
                            icon: "error",
                            title: "Error",
                            text: response.error
                        });
                    }
                }
            });
        });
    </script>
{% endblock javascripts %}
