{% load static %}
<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DocuFlow - Cargar Documentos</title>
    <link rel="stylesheet" href="{% static 'css_carga_doc.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>

    <header class="dashboard-header">
        <!--<div class="logo-text">DocuFlow</div>-->
        <img src="{% static 'logo_capstone_2.png' %}" alt="DocuFlow Logo" class="logo-image" width="200" height="150">
        <div class="header-center">
            <div class="search-bar">
                <i class="fas fa-search"></i>
                <input type="text" placeholder="Search documents...">
            </div>
        </div>
        
        <div class="header-right">
            {% if request.user.is_authenticated %}
                <span class="user-display" style="margin-right: 15px; font-weight: 600;">
                    Hola, {{ request.user.first_name|default:request.user.username }} 👋
                </span>
            {% endif %}
            <button class="icon-button"><i class="fas fa-bell notification-button"></i></button>
            <button class="icon-button"><i class="fas fa-user-circle"></i></button>
        </div>
    </header>

    <div class="dashboard-wrapper">

        <aside class="sidebar">
            <nav class="sidebar-nav">
                <a href="/colaboradores/" class="nav-item">
                    <i class="fas fa-th-large"></i> Inicio
                </a>
                <a href="{% url 'carga_documentos' %}" class="nav-item active"> <i class="fas fa-file-alt"></i> Carga
                    Documentos
                </a>
                <a href="{% url 'proyectos' %}" class="nav-item">
                    <i class="fas fa-sitemap"></i>
                    Proyectos
                </a>
                <a href="#" class="nav-item">
                    <i class="fas fa-users"></i> Equipo
                </a>
                <div style="flex-grow: 1;"></div>
                <a href="{% url 'login' %}" class="nav-item logout-item"> <i class="fas fa-sign-out-alt"></i> Cerrar
                    Sesión
                </a>
            </nav>
            <div class="new-project-button-container" style="padding: 20px;">
                <a href="/#/" class="login-button"><i class="fas fa-plus"></i> Nuevo Proyecto</a>
            </div>
        </aside>
        <main class="main-content-area">

            <div class="upload-main-form">

                <section class="card upload-form-section" style="padding: 30px;">
                    <h1 style="margin-top: 0; font-size: 24px;">Subir Nuevo Documento</h1>
    
                        {% if messages %}
                            {% for message in messages %}
            
            

                            <div class="alert alert-{{ message.tags }}" 
                                style="padding: 15px; margin-bottom: 20px; border-radius: 4px; 
                                        background-color: #f0f3fa; 
                                        color: #1f538d; 
                                        border: 1px solid #cce5ff;">
                            {{ message }}
                            </div>s

                            {% endfor %}
                        {% endif %}
                </section>

                    <form id="upload-form" method="POST" enctype="multipart/form-data">
                        {% csrf_token %}

                        <div style="display: flex; gap: 20px; margin-top: 20px;">
                            <div class="form-group" style="flex: 1;">
                                <label for="document_title">Titulo de Documento</label>
                                {{ form.titulo }}
                            </div>
                            <div class="form-group" style="flex: 1;">
                                <label for="project_select">Asociación a Proyecto</label>
                                {{ form.proyecto_asociado }}
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="document_type">Tipo Documento</label>
                            {{ form.tipo_documento }}
                        </div>

                        {{ form.archivo }}

                        <div class="form-group" style="margin-top: 20px;">
                            <label>Archivo a Subir</label>
                            <button type="button" class="login-button" id="select-file-button" ...>
                                <i class="fas fa-upload"></i> Seleccionar Documento
                            </button>
                            <div id="file-info-display"
                                style="margin-top: 10px; padding: 10px; border: 1px solid #ccc; border-radius: 5px; background-color: #f9f9f9; display: none;">
                                <p><strong>Archivo Seleccionado:</strong> <span id="file-name">Ninguno</span></p>
                                <p><strong>Autor:</strong> <span id="author-name">{{ autor_nombre }}</span></p>
                            </div>
                        </div>

                        <div style="margin-top: 30px; text-align: right;">
                            <button type="submit" class="login-button" style="padding: 10px 25px;">
                                <i class="fas fa-save"></i> Guardar y Subir
                            </button>
                        </div>
                    </form>

                </section>

            </div>

        </main>
    </div>

    <script>
        // Script de interacción para el botón de subida
        const fileInput = document.getElementById('document_file');
        const selectFileButton = document.getElementById('select-file-button');
        const fileNameSpan = document.getElementById('file-name');
        const fileInfoDisplay = document.getElementById('file-info-display');

        // Función que asegura que el botón activa el input file
        selectFileButton.addEventListener('click', () => {
            fileInput.click();
        });

        // Función que actualiza el nombre del archivo seleccionado
        fileInput.addEventListener('change', () => {
            if (fileInput.files.length > 0) {
                const file = fileInput.files[0];
                fileNameSpan.textContent = file.name;
                fileInfoDisplay.style.display = 'block';
            } else {
                fileNameSpan.textContent = 'Ninguno';
                fileInfoDisplay.style.display = 'none';
            }
        });
    </script>
</body>

</html>